<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    // // 父子通信 eventEmitter
    class EventEmitter1 {
      constructor() {
        this.events = {}
      }
      on(eventName, fn) {
        if (!this.events[eventName]) {
          this.events[eventName] = []
        }
        this.events[eventName].push(fn)
      }
      emit(eventName, ...rest) {
        this.events[eventName] && this.events[eventName].forEach(f => f.apply(this, rest))
      }
      // remove(eventName, fn) {
      //   if (this.events[eventName]) {
      //     this.events[eventName].filter(f => f !== fn)
      //   }
      // }
      // once(eventName, callback) {
      //   const fn = () => {
      //     callback();
      //     this.remove(eventName, fn)
      //   }
      //   this.on(eventName, fn)
      // }
    }

    class EventEmitter {
      constructor() {
        this.events = {}
      }
      on(name,fn){
        if(!this.events[name]){
          this.events[name]=[]
        }
        this.events[name].push(fn)
      }
      emit(name, ...rest){
        this.events[name] && this.events[name].forEach(fn=>fn.apply(this,rest))
      }
      remove(name,fn){
        if(this.events[name]){
          this.events[name].filter(f=>f !== fn)
        }
      }
      once(name,fn){
        const callbank=()=>{
          fn();
          this.remove(name,callbank)
        }
        this.on(name,callbank)
      }
    }
    const event = new EventEmitter()

    const handle = (...pyload) => console.log(pyload)

    event.on('click', handle)

    event.emit('click', 100, 200, 300, 100)

    event.remove('click', handle)

    event.once('dbclick', function () {
      console.log('click')
    })

    event.emit('dbclick', 100);
  </script>
</body>

</html>